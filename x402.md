# x402 Protocol

x402 is the machine-to-machine payments model for XELVYN. It uses the HTTP 402 (Payment Required) pattern together with USDC payments on the Base network (Chain ID 8453).

## Why USDC on Base

- Price stability: USDC provides predictable budgeting.
- Low fees: typical fees under $0.01 per transaction on Base.
- Fast confirmations: suitable for micropayments.
- EVM-compatible: full compatibility with Ethereum tooling and explorers.

## Transaction Flow

1. Agent requests a paid resource from a service.
2. Service responds with HTTP 402 and a payment specification.
3. Agent constructs and signs a USDC payment on Base.
4. Agent submits the transaction to Base and obtains `txHash`.
5. Agent retries the original request including a payment proof header (e.g., `X-XELVYN-PAYMENT: txHash`).

## Payment Channels

- Channels are per-agent and funded by the operator.
- The channel private key is generated and stored only on the VPS. It is never transmitted off the VPS.

## CLI Commands

- `xelvyn x402 balance` — show USDC balance for agent channels.
- `xelvyn x402 fund <amount>` — fund the agent channel in USDC.
- `xelvyn x402 history` — show x402 transaction history.

## SDK Methods

- `client.x402.balance()`
- `client.x402.fund(agentName, amountUSDC)`
- `client.x402.history()`

## Configuration

Set per-agent spending limit:

```bash
xelvyn config set x402.maxSpend 10
```

## Transparency and Auditing

Every x402 transaction is recorded on-chain and is auditable via the CLI, Dashboard, or Base block explorers.
